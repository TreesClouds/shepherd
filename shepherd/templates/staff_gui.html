<html>
<!--I like cheese-->
<head>
  <title>Staff UI</title>
  <script type="text/javascript" src={{url_for( 'static' , filename='jquery-1.12.3.min.js' )}}></script>
  <!-- <script type="text/javascript" src={{url_for( 'static' , filename='tabletop.js' )}}></script> -->
  <!-- <script type="text/javascript" src={{url_for( 'static' , filename='lcm_ws_bridge.js' )}}></script> -->
  <script type="text/javascript" src={{url_for( 'static' , filename='socket.io.js' )}}></script>
  <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.4/socket.io.js"></script> -->

  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="{{url_for('static', filename='bootstrap.min.css')}}">
  <!-- <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"> -->

  <!-- Styles -->
  <style>
    /*Disables spinning on number forms*/

    input[type="number"]::-webkit-outer-spin-button,
    input[type="number"]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }

    input[type="number"] {
      -moz-appearance: textfield;
    }

    .bottom-padding {
      margin-bottom: 25px;
    }

    .form-inline {
      flex-flow: row;
    }

    .spaced {
      margin:5px;
    }

    .heartbeat-light {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background-color: lightgrey;
      box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #444444 0 -1px 9px;
    }
    .led-green {
      background-color: #ABFF00;
      box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #304701 0 -1px 9px, #89FF00 0 2px 12px;
    }
    .led-red {
      background-color: #F00;
      box-shadow: rgba(0, 0, 0, 0.2) 0 -1px 7px 1px, inset #441313 0 -1px 9px, rgba(255, 0, 0, 0.5) 0 2px 12px;
    }
  </style>
  <script>
    $(document).ready(function () {

      var socket = io('/');
      var match_num = "";
      var round_num = "";
      var team_num = "";
      var team_name = "";
      var custom_ip = "";


      socket.on('connect', function (data) {
        socket.emit('join', 'staff_gui');
        socket.emit('ui-to-server-teams-info-request');
      });

      socket.on('server-to-ui-teamsinfo', function (data) {
        console.log("server-to-ui-teams-info")
        parsed_data = JSON.parse(data)
        console.log(parsed_data)
        match_num = parsed_data.match_num
        console.log(match_num)
        round_num = parsed_data.round_num
        team_num = parsed_data.team_num
        team_name = parsed_data.team_name
        custom_ip = parsed_data.custom_ip // check if this is sent / used
        setDefaultTeamsInfo()
      });

      $("#next-round").click(() => {
        console.log("next round button pressed");
      })

      $("#next-match").click(() => {
        console.log("next match button pressed");
      })

      $("#select-round").click(() => {
        console.log("populate button pressed");
        match_num = $("#select-match-number").val();
        round_num = $("#select-round-number").val();
        socket.emit('ui-to-server-teams-info-request', JSON.stringify({ "match_num": match_num, "round_num": round_num }));
      });

      $("#create-match").click(() => {
        setTeamsInfoVars();
        socket.emit('ui-to-server-setup-match', JSON.stringify(data));
      });



      function setDefaultTeamsInfo() {
        $("#match-number").text(match_num);
        $("#round-number").text(round_num);
        $("#team-number").text(team_num);
        $("#team-name").text(team_name);
      }

      function setTeamsInfoVars() {
        match_num = $("#match-number").text();
        round_num = $("#round-number").text();
        team_num = $("#team-number").text();
        team_name = $("#team-name").text();
      }

      $("#submit-tinder").click(function () {
        var tinder = $("#tinder").val();
        socket.emit('ui-to-server-game-info', JSON.stringify({ "tinder": tinder }));
      });

      $("#submit-buttons").click(function () {
        var buttons = $("#buttons").val();
        socket.emit('ui-to-server-game-info', JSON.stringify({ "buttons": buttons }));
      });

      $("#round-start").click(function () {
        socket.emit('ui-to-server-start-next-stage');
      });


      $("#round-reset").click(function () {
        socket.emit('ui-to-server-reset-match');
      });
      /*
      socket.on('server-to-ui-connections', function (data) {
        //parsed_data = JSON.parse(data);
        //toggleConnection(parsed_data.robot_connection);
      });

      // Heartbeat
      function toggleHeartbeat(connected) {
        // TODO: add this div, copying other hb divs
        toggleLed($(".hb"), connected);
      }

      function toggleLed(lightObj, connected) {
        lightObj.toggleClass("led-green", connected);
        lightObj.toggleClass("led-red",  !connected);
        console.log(lightObj);
      }
      */
    });
  </script>
</head>

<body>

  <nav class="navbar navbar-expand-sm navbar-light bg-light">
    <a class="navbar-brand" href="#">Staff UI</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item active">
          <a class="nav-link" href="../staff_gui.html">Match Creator<span class="sr-only">(current)</span></a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../score_adjustment.html">Score Adjustment</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../ref_gui.html">Ref GUI</a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="container" style="max-width:1405px">

    <div class="row">
      <div class="btn-group bottom-padding" role="group" aria-label="...">
        <h3>Match #:</h3><h3 id="match-number"></h3>
        <h3>Round #:</h3><h3 id="round-number"></h3>
        <button type="button" class="btn btn-success spaced" id="next-round"><span class="glyphicon glyphicon-play"
            aria-hidden="true"></span>Next Round</button>
        <button type="button" class="btn btn-success spaced" id="next-match"><span class="glyphicon glyphicon-play"
            aria-hidden="true"></span>Next Match</button>
        <div class="form-group">
          <input type="number" class="form-control spaced" id="select-match-number" style="width: 81px;" placeholder="Match #">
        </div>
        <div class="form-group">
          <input type="number" class="form-control spaced" id="select-round-number" style="width: 81px;" placeholder="Round #">
        </div>
        <button type="button" class="btn btn-success spaced" id="select-round"><span class="glyphicon glyphicon-play"
            aria-hidden="true"></span>Populate</button>
      </div>
    </div>

    <div class="row">
      <div class="btn-group bottom-padding" role="group" aria-label="...">
        <h3>Team #:</h3><h3 id="team-number"></h3>
        <h3>Team Name:</h3><h3 id="team-name"></h3>
        <div class="form-group">
          <input type="number" class="form-control spaced" id="tinder" style="width: 81px;" placeholder="Tinder">
        </div>
        <button type="button" class="btn btn-success spaced" id="submit-tinder"><span class="glyphicon glyphicon-play"
            aria-hidden="true"></span>Submit Tinder</button>
        <div class="form-group">
          <input type="number" class="form-control spaced" id="buttons" style="width: 81px;" placeholder="Buttons">
        </div>
        <button type="button" class="btn btn-success spaced" id="submit-buttons"><span class="glyphicon glyphicon-play"
            aria-hidden="true"></span>Submit Buttons</button>
        
      </div>
    </div>

    <div class="row bottom-padding">
      <div class="col">
        <div class="input-group">
          <h3>Custom IP: <span id="custom-ip"></span></h3>
          <span class="input-group-btn">
            <button class="btn btn-success" type="button" id="custom-ip-change">Change</button>
          </span>
          <input type="url" class="form-control" placeholder="0.0.0.0" id="custom-ip-adjustment">
        </div>
      </div>
    </div>

    <div class="row">
      <div class="btn-group bottom-padding" role="group">
        <span class="spaced">Heartbeat:</span> 
        <div class="form-group spaced heartbeat-light hb"></div>
      </div>
    </div>

    <div class="row">
      <div class="btn-group bottom-padding" role="group" aria-label="...">
        <button type="button" class="btn btn-success spaced" id="create-match"><span class="glyphicon glyphicon-play"
            aria-hidden="true"></span>Create Match</button>
        <button type="button" class="btn btn-success spaced" id="round-start"><span class="glyphicon glyphicon-play"
            aria-hidden="true"></span>Start Round</button>
        <button type="button" class="btn btn-danger spaced" id="round-reset"><span class="glyphicon glyphicon-fast-backward"
            aria-hidden="true"></span>Reset Round</button>
      </div>
    </div>
  </div>
</body>


</html>

</html>